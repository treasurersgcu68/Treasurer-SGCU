<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Treasurer SGCU</title>
    <meta name="description" content="ระบบติดตามสถานะโครงการ งบประมาณ และงานบริหารการเงินของ SGCU 68 พัฒนาโดยฝ่ายเหรัญญิก">
    <meta name="description" content="ระบบติดตามโครงการและงบประมาณของเหรัญญิก SGCU68 (อบจ68) สำหรับดูสถานะโครงการ Project Status SGCU การใช้จ่าย และข้อมูลการบริหารงบอย่างโปร่งใส">
    <meta name="keywords" content="เหรัญญิก SGCU68, เหรัญญิก อบจ68, SGCU, อบจ, งบประมาณ SGCU, Project Status SGCU, Treasurer SGCU, SGCU68">
    <meta name="author" content="Treasurer SGCU68">
    <meta property="og:title" content="เหรัญญิก SGCU68 | ระบบติดตามโครงการและงบประมาณ">
    <meta property="og:description" content="ดูสถานะโครงการ (Project Status SGCU) และงบประมาณแบบอัปเดตโดยเหรัญญิก อบจ68">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://treasurersgcu68.github.io/Treasurer-SGCU/">
    <link rel="icon" type="image/png" href="img/logo_treasurur jpg1.png">
    <link rel="apple-touch-icon" href="img/logo_treasurur jpg1.png">

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
    <link rel="preconnect" href="https://www.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
    <!-- PapaParse -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>
    <!-- html2pdf -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" defer></script>
    <!-- Firebase (Auth) -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
      import {
        getAuth,
        onAuthStateChanged,
        signInWithPopup,
        GoogleAuthProvider,
        signOut,
        signInWithEmailAndPassword
      } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDcRIz1Uy1AZd-9JJdLF92SyqU6m8bdSXo",
        authDomain: "departmentwebsite-5aec1.firebaseapp.com",
        projectId: "departmentwebsite-5aec1",
        storageBucket: "departmentwebsite-5aec1.firebasestorage.app",
        messagingSenderId: "827589080688",
        appId: "1:827589080688:web:ad89c53218104f908926b5",
        measurementId: "G-BFW19TSYL0"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      window.sgcuAuth = {
        auth,
        GoogleAuthProvider,
        signInWithPopup,
        signOut,
        onAuthStateChanged,
        signInWithEmailAndPassword
      };
    </script>
  </head>
  <body>
    <div id="appLoader" class="app-loader" aria-live="polite" aria-busy="true">
      <div class="app-loader-panel">
        <div class="app-loader-logo" aria-hidden="true">
          <img src="img/logo_treasurur jpg.png" alt="" />
        </div>
        <div class="app-loader-title">Treasurer SGCU</div>
        <div class="app-loader-status">
          กำลังเชื่อมต่อข้อมูล <span id="appLoaderPercent" class="app-loader-percent">0</span>%
        </div>
        <div class="app-loader-progress" aria-hidden="true"><span id="appLoaderBar"></span></div>
      </div>
    </div>
    <header class="site-header">
      <div class="header-inner">
        <div class="logo">
          <div class="logo-mark">
            <a
              href="https://www.instagram.com/treasurer.sgcu?igsh=MXR0cXM0NWY5N3UwYg=="
              target="_blank"
              rel="noopener noreferrer"
            >
              <img
                src="./img/logo_treasurur jpg.png"
                alt="Treasurer SGCU68"
                class="home-hero-badge-img"
              />
            </a>
          </div>
          <div class="logo-text">
            <div class="logo-title">Treasurer SGCU</div>
            <div class="logo-subtitle">ฝ่ายเหรัญญิก องค์การบริหารสโมสรนิสิตจุฬาฯ</div>
          </div>
        </div>

        <nav class="desktop-nav">
          <a href="#" data-page="home" class="active" data-visible="public">Home</a>
          <a href="#" data-page="dashboard-staff" data-visible="protected">Dashboard</a>
          <a href="#" data-page="project-status" data-visible="public">Project Status</a>
          <a href="#" data-page="financial-docs" data-visible="public">Financial Documents</a>
          <a href="#" data-page="borrow-assets" data-visible="protected">Borrow &amp; Return Assets</a>
          <a href="#" data-page="login" data-visible="public">Sign in</a>
        </nav>

        <div class="header-actions">
          <div class="auth-panel" id="authPanel">
            <span id="userInfo" class="auth-user"></span>
          </div>
          <div id="staffModeToggle" class="staff-mode-toggle">
            <span class="staff-mode-label">โหมด</span>
            <button class="staff-mode-btn is-active" data-staff-mode="normal" type="button">ปกติ</button>
            <button class="staff-mode-btn" data-staff-mode="staff" type="button">Staff</button>
          </div>

          <label
            id="hamburgerBtn"
            class="burger"
            aria-label="เปิด/ปิดเมนูหลัก"
            aria-expanded="false"
            aria-controls="mobileMenu"
            role="button"
          >
            <input id="hamburgerToggle" type="checkbox" aria-hidden="true" />
            <span></span><span></span><span></span>
          </label>
        </div>
      </div>

      <div id="mobileMenu" class="mobile-menu">
        <nav>
          <a href="#" data-page="home" data-visible="public">Home</a>
          <a href="#" data-page="dashboard-staff" data-visible="protected">Dashboard</a>
          <a href="#" data-page="project-status" data-visible="public">Project Status</a>
          <a href="#" data-page="financial-docs" data-visible="public">Financial Documents</a>
          <a href="#" data-page="borrow-assets" data-visible="protected">Borrow &amp; Return Assets</a>
          <a href="#" data-page="login" data-visible="public">Sign in</a>
          <button
            id="mobileLogoutBtn"
            type="button"
            class="auth-btn ghost mobile-menu-logout"
            style="display:none;"
          >
            Sign Out
          </button>
        </nav>
      </div>
    </header>

    <main class="main">
      <!-- HOME PAGE -->
      <section class="page-view active section-appear" data-page="home">
          <!-- 1. HERO -->
           
          <div class="home-hero">
            <div class="home-hero-inner">
              <!-- ซ้าย: ข้อความหลัก -->
              <div class="home-hero-text">
                <div class="home-hero-eyebrow">เหรัญญิก SGCU68</div>
                <h1 class="home-hero-title">
                  งบนิสิต เพื่อนิสิตของจุฬาฯ
                </h1>
                <p class="home-hero-subtitle">
                  เราเชื่อว่าความโปร่งใสคือพื้นฐานของความไว้วางใจ
                  ทุกโครงการของนิสิตสามารถติดตามได้ทั้งงบประมาณและเอกสารภายในเว็บไซต์นี้
                </p>

                <!-- ปุ่มหลัก -->
                <div class="home-hero-actions">
                  <button
                    class="btn-primary"
                    type="button"
                    data-goto-page="project-status"
                  >
                    ดูสถานะโครงการทั้งหมด
                  </button>
                  <button
                    class="btn-secondary"
                    type="button"
                    data-goto-page="financial-docs"
                  >
                    ดาวน์โหลดเอกสารการเงิน
                  </button>
                </div>
              </div>

              <!-- ขวา: เหรียญ Treasurer -->              
              <div class="home-hero-badge">
                <div class="home-hero-highlight">
                  <a
                    href="https://www.instagram.com/treasurer.sgcu?igsh=MXR0cXM0NWY5N3UwYg=="
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <img src="./img/logo_treasurur jpg.png" alt="Treasurer SGCU68" class="home-hero-badge-img" />
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- 2. ข่าว / ประกาศสั้น -->
          <section class="home-news section-appear">
            <header class="home-section-header">
              <h2>ข่าวและประกาศจากฝ่ายเหรัญญิก</h2>
              <p>สรุปสิ่งที่ทีมเหรัญญิกอยากแจ้งให้ชมรมและนิสิตทราบ</p>
            </header>
            <div id="homeNewsSkeleton" class="home-news-skeleton skeleton-grid" aria-hidden="true">
              <div class="skeleton-card">
                <div class="skeleton-line short"></div>
                <div class="skeleton-line"></div>
                <div class="skeleton-line tiny"></div>
              </div>
              <div class="skeleton-card">
                <div class="skeleton-line short"></div>
                <div class="skeleton-line"></div>
                <div class="skeleton-line tiny"></div>
              </div>
            </div>
            <div id="homeNewsPreview" class="home-news-grid"></div>
          </section>

          <!-- 4. ขอบเขตงานของทีมเหรัญญิก -->
          <section class="home-scope section-appear">
            <header class="home-section-header">
              <h2>ทีมเหรัญญิกดูแลเรื่องอะไรบ้าง?</h2>
              <p>เลือกหัวข้อเพื่อดูว่าทีมไหนดูแลเรื่องใดในฝ่ายเหรัญญิก SGCU68</p>
            </header>

            <!-- Pills -->
            <div class="home-scope-pills">
              <button
                class="scope-pill scope-pill-active"
                type="button"
                data-scope-target="treasurer"
              >
                เหรัญญิก
              </button>
              <button
                class="scope-pill"
                type="button"
                data-scope-target="budget"
              >
                บริหารและพัฒนางบประมาณ
              </button>
              <button
                class="scope-pill"
                type="button"
                data-scope-target="fundraising"
              >
                หาทุนและสิทธิประโยชน์
              </button>
              <button
                class="scope-pill"
                type="button"
                data-scope-target="assets"
              >
                กายภาพและพัสดุ
              </button>
            </div>

            <!-- การ์ดทีม -->
            <div class="home-scope-grid">
              <!-- การ์ดใหม่: เหรัญญิก (ค่า default) -->
              <div class="scope-team-card scope-team-active" data-scope="treasurer">
                <h3>เหรัญญิก</h3>
                <p>
                  ดูแลระบบการเงินทั้งหมดขององค์การบริหารสโมสรนิสิต ตั้งแต่การวางแผนงบประมาณ
                  ตรวจสอบคำของบ ดูแลการใช้จ่าย ไปจนถึงการปิดโครงการและรายงานต่อสภานิสิต
                </p>
                <ul>
                  <li>กำกับดูแลการทำงานของทุกฝ่ายในทีมเหรัญญิก</li>
                  <li>ตรวจสอบให้การใช้จ่ายเป็นไปตามระเบียบมหาวิทยาลัย</li>
                  <li>สื่อสารนโยบายและคู่มือการเงินให้ชมรมและนิสิตเข้าใจตรงกัน</li>
                </ul>
              </div>

              <div class="scope-team-card" data-scope="budget">
                <h3>ฝ่ายบริหารและพัฒนางบประมาณ</h3>
                <p>
                  ดูแลภาพรวมงบประมาณของ SGCU68 วางแผน แบ่งสัดส่วนงบ
                  และติดตามการใช้จ่ายของโครงการทุกฝ่ายให้เป็นไปตามระเบียบมหาวิทยาลัย
                </p>
                <ul>
                  <li>กำหนดกรอบงบประมาณรายปี</li>
                  <li>ตรวจสอบความครบถ้วนของคำของบประมาณโครงการ</li>
                  <li>สรุปภาพรวมการใช้จ่ายให้คณะกรรมการบริหารและสภานิสิต</li>
                </ul>
              </div>

              <div class="scope-team-card" data-scope="fundraising">
                <h3>ฝ่ายหาทุนและสิทธิประโยชน์</h3>
                <p>
                  ประสานงานการหาทุน สปอนเซอร์ และสิทธิประโยชน์ต่าง ๆ
                  เพื่อสนับสนุนกิจกรรมของสโมสรนิสิตและชมรม
                </p>
                <ul>
                  <li>จัดทำแพ็กเกจสปอนเซอร์</li>
                  <li>ประสานกับบริษัท / หน่วยงานภายนอก</li>
                  <li>ติดตามการใช้โลโก้และสิทธิประโยชน์ให้ถูกต้องตามข้อตกลง</li>
                </ul>
              </div>

              <div class="scope-team-card" data-scope="assets">
                <h3>ฝ่ายกายภาพและพัสดุ</h3>
                <p>
                  ดูแลครุภัณฑ์ อุปกรณ์ และทรัพย์สินของสโมสรนิสิต รวมถึงระบบการยืมคืน
                  และการบำรุงรักษาให้อยู่ในสภาพพร้อมใช้งาน
                </p>
                <ul>
                  <li>จัดเก็บข้อมูลพัสดุและสถานะการใช้งาน</li>
                  <li>ดูแลการยืมคืนอุปกรณ์ให้เป็นระบบ</li>
                  <li>ประสานงานซ่อมบำรุงเมื่ออุปกรณ์ชำรุด</li>
                </ul>
              </div>
            </div>
          </section>

          <!-- 5. โครงสร้างทีมเหรัญญิก -->
          <section class="home-org section-appear">
            <header class="home-section-header">
              <h2>โครงสร้างทีมเหรัญญิก SGCU68</h2>
              <p>ดูภาพรวมโครงสร้างทีมเหรัญญิกและสายการทำงานของแต่ละฝ่าย</p>
            </header>

            <div id="orgStructureSkeleton" class="org-structure-skeleton skeleton-grid" aria-hidden="true">
              <div class="skeleton-card">
                <div class="skeleton-line"></div>
                <div class="skeleton-line short"></div>
                <div class="skeleton-line tiny"></div>
              </div>
              <div class="skeleton-card">
                <div class="skeleton-line"></div>
                <div class="skeleton-line short"></div>
                <div class="skeleton-line tiny"></div>
              </div>
              <div class="skeleton-card">
                <div class="skeleton-line"></div>
                <div class="skeleton-line short"></div>
                <div class="skeleton-line tiny"></div>
              </div>
            </div>

            <!-- container ที่ JS จะเติมแผนผังทีมเหรัญญิก -->
            <div id="org-structure-content" class="org-structure-wrapper"></div>
          </section>

          <!-- 6. SCOREBOARD SGCU-10.001 -->
          <section class="home-scoreboard section-appear">
            <header class="home-section-header">
              <h2>ผลการแข่งขันโครงการ SGCU-10.001</h2>
              <p>
                โครงการส่งเสริมการปิดโครงการอย่างมีประสิทธิภาพขององค์กรนิสิตภายใต้สโมสรนิสิตจุฬาลงกรณ์มหาวิทยาลัย<br />
                ประจำปีการศึกษา 2568
              </p>
            </header>

            <div class="scoreboard-wrapper">
              <!-- Podium 3 อันดับแรก -->
              <div id="scorePodium" class="score-podium">
                <!-- JS จะเติมเนื้อหา -->
                <div class="score-loading">กำลังโหลดผลคะแนน...</div>
              </div>

              <!-- Runners-up -->
              <div id="scoreRunners" class="score-runners">
                <!-- JS จะเติมเนื้อหา -->
              </div>
            </div>
          </section>
      </section>

      <!-- ============ PROJECT STATUS ============ -->
      <section class="page-view" data-page="project-status">
        <div class="page">
          <!-- Header + Toggle -->
          <div class="page-header-flex">
            <div>
              <h1 class="page-title">สถานะโครงการ</h1>
            </div>

            <!-- Toggle ระหว่างมุมมองสรุป / Dashboard / ปฏิทิน -->
            <div class="tabs">
              <button
                class="tab-btn view-toggle-btn is-active"
                type="button"
                data-view="status"
              >
                สรุปสถานะโครงการ
              </button>
              <button
                class="tab-btn view-toggle-btn"
                type="button"
                data-view="calendar"
              >
                ปฏิทินโครงการ
              </button>
            </div>
          </div>

          <!-- ================= STATUS VIEW ================= -->
          <div id="statusView">
            <!-- Filter หลัก -->
            <div class="filter-bar">
              <div class="filter-group filter-year">
                <label for="yearSelect">ปีการศึกษา</label>
                <select id="yearSelect">
                  <option value="all">ทุกปีการศึกษา</option>
                  <option value="2568" selected>2568</option>
                </select>
              </div>

              <div class="filter-group filter-orgtype">
                <label for="orgTypeSelect">ประเภทองค์กร</label>
                <select id="orgTypeSelect">
                  <option value="all">ทุกประเภทองค์กร</option>
                  <!-- JS จะเติมฝ่าย/กลุ่มองค์กรเพิ่ม -->
                </select>
              </div>

              <div class="filter-group filter-org">
                <label for="orgSelect">ฝ่าย / ชมรม</label>
                <select id="orgSelect">
                  <option value="all">ทุกฝ่าย / ทุกชมรม</option>
                  <!-- JS จะเติมรายชื่อชมรม/ฝ่ายเพิ่ม -->
                </select>
              </div>

              <div class="filter-group filter-search">
                <label for="projectSearchInput">ค้นหาข้อความ (โค้ด / ชื่อ / ฝ่าย)</label>
                <div class="search-box">
                  <input
                    id="projectSearchInput"
                    type="search"
                    placeholder="พิมพ์คำค้น เช่น SGCU-01 หรือ ชมรมกีฬา"
                  />
                  <button id="projectSearchClear" class="search-clear" type="button" aria-label="เคลียร์คำค้น">
                    ✕
                  </button>
                </div>
              </div>
            </div>

            <!-- การ์ดสรุป -->
            <div class="cards section-appear section-delay-1">
              <article class="card card-hover">
                <div class="card-title">จำนวนโครงการทั้งหมด</div>
                <div id="totalProjects" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">โครงการอยู่ระหว่างดำเนินการ</div>
                <div id="pendingProjects" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">โครงการที่อนุมัติแล้ว</div>
                <div id="approvedProjects" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">โครงการที่ปิดโครงการแล้ว</div>
                <div id="closedProjects" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">วงเงินโครงการรวม (บาท)</div>
                <div id="totalBudget" class="card-value">0</div>
                <div class="card-caption">บาท</div>
              </article>
            </div>

            <!-- กราฟสถานะปิดโครงการ + Pie งบประมาณ -->
            <div class="chart-grid section-appear section-delay-2" style="margin-top:16px;">
              <!-- Stacked bar -->
              <article class="chart-card">
                <header class="chart-header">
                  <h3 class="chart-title">ภาพรวมสถานะปิดโครงการ</h3>
                </header>
                <div class="chart-inner">
                  <div id="budgetChartSkeleton" class="chart-skeleton"></div>
                  <canvas id="budgetByMonthChart"></canvas>
                </div>
              </article>

              <!-- Pie chart -->
              <article class="chart-card">
                <header class="chart-header">
                  <h3 class="chart-title">สัดส่วนงบประมาณโครงการที่ได้รับอนุมัติ</h3>
                </header>
                <div class="chart-inner">
                  <div id="statusPieSkeleton" class="chart-skeleton"></div>
                  <canvas id="statusPieChart"></canvas>
                </div>
              </article>
            </div>

            <!-- ตารางรายการโครงการ -->
            <section class="panel section-appear section-delay-3" style="margin-top:18px;">
              <header class="panel-header">
                <div>
                  <h3 class="panel-title">รายการโครงการ</h3>
                </div>
              </header>

              <div class="table-wrapper" id="projectTableArea">
                <div class="project-table-wrapper">
                  <table id="projectTable">
                    <caption id="tableCaption">แสดง 0 โครงการ</caption>
                    <thead>
                      <tr>
                        <th style="text-align:center;">รหัสโครงการ</th>
                        <th style="text-align:center;">ชื่อโครงการ</th>
                        <th class="sortable" data-sort="year" style="text-align:center;">
                          ปีการศึกษา
                        </th>
                        <th class="sortable" data-sort="status" style="text-align:center;">
                          สถานะ
                        </th>
                        <th class="sortable" data-sort="budget" style="text-align:right;">
                          งบประมาณ (บาท)
                        </th>
                      </tr>
                    </thead>
                    <tbody id="projectTableBody">
                      <!-- JS ใส่ข้อมูลโครงการ -->
                    </tbody>
                  </table>
                </div>

                <div id="projectTableSkeleton" class="table-skeleton"></div>
              </div>

              <div id="projectTableLock" class="panel project-lock-panel">
                <h3 class="panel-title">ต้องเข้าสู่ระบบก่อน</h3>
                <p class="panel-caption">
                  กรุณาล็อกอินเพื่อดูรายละเอียดโครงการ
                </p>
                <div style="margin-top:10px;">
                  <button class="btn-primary" type="button" data-goto-page="login">ไปที่หน้า Sign in</button>
                </div>
              </div>
            </section>
          </div>

          <!-- ================= CALENDAR VIEW ================= -->
          <div id="calendarView" style="display:none; margin-top:12px;">
            <section class="panel section-appear section-delay-1">
              <header class="panel-header">
                <div>
                  <h3 id="calendarPanelTitle" class="panel-title">
                    ปฏิทินกิจกรรม —
                  </h3>
                  <p class="panel-caption">
                    แสดงวันจัดกิจกรรมตามวันสิ้นสุดการปฏิบัติงานของแต่ละโครงการ
                  </p>
                </div>
                <div class="calendar-controls">
                  <button id="prevMonthBtn" type="button" class="btn-ghost">
                    ‹ เดือนก่อนหน้า
                  </button>
                  <button id="nextMonthBtn" type="button" class="btn-ghost">
                    เดือนถัดไป ›
                  </button>
                </div>
              </header>

              <!-- Filters -->
              <div class="calendar-filter-bar">
                <div class="filter-group">
                  <label for="calendarYearSelect">ปีการศึกษา</label>
                  <select id="calendarYearSelect">
                    <option value="all">ทุกปีการศึกษา</option>
                  </select>
                </div>
                <div class="filter-group">
                  <label for="calendarOrgSelect">ฝ่าย / ชมรม</label>
                  <select id="calendarOrgSelect">
                    <option value="all">ทุกฝ่าย / ทุกชมรม</option>
                  </select>
              </div>
              <div class="filter-group">
                <label for="calendarStatusSelect">สถานะโครงการ</label>
                <select id="calendarStatusSelect">
                  <option value="all">ทุกสถานะ</option>
                    <option value="pending">อยู่ระหว่างดำเนินการ</option>
                    <option value="approved">อนุมัติโครงการแล้ว</option>
                    <option value="closed">ปิดโครงการแล้ว</option>
                  </select>
                </div>
              </div>

              <!-- Skeleton ปฏิทิน -->
              <div id="calendarSkeleton" class="calendar-skeleton" aria-hidden="true">
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
              </div>

              <!-- กริดปฏิทิน -->
              <div id="calendarContainer" class="calendar-grid"></div>

              <div class="home-timeline-footer" style="margin-top:12px;">
                <span class="pill pill-soft-gray">อยู่ระหว่างดำเนินการ</span>
                <span class="pill pill-soft-pink">อนุมัติโครงการแล้ว</span>
                <span class="pill pill-soft-green">ปิดโครงการแล้ว</span>
              </div>
            </section>
          </div>

        </div>
      </section>


      <!-- ============ DASHBOARD (STAFF) ============ -->
      <section class="page-view" data-page="dashboard-staff">
        <div class="page">
          <div class="page-header-flex">
            <div>
              <h1 class="page-title">Dashboard ภาพรวม</h1>
            </div>
          </div>

          <div id="filterBarHostDashboardStaff"></div>

          <section class="dashboard-overview section-appear section-delay-1">
            <header class="panel-header">
              <div>
                <h3 class="panel-title">ภาพรวมโครงการ</h3>
                <p class="panel-caption">สรุปอัตราสถานะ งบเฉลี่ย และหน่วยงานที่ใช้งบสูงสุด</p>
              </div>
            </header>

            <div class="dashboard-grid">
              <article class="dashboard-metric">
                <div class="metric-label">งบประมาณเฉลี่ยต่อโครงการ</div>
                <div id="avgBudgetStaff" class="metric-value">0</div>
                <div id="avgBudgetCaptionStaff" class="metric-caption">-</div>
              </article>

              <article class="dashboard-metric">
                <div class="metric-label">จำนวนฝ่าย/ชมรมที่มีโครงการ</div>
                <div id="activeOrgCountStaff" class="metric-value">0</div>
                <div id="activeOrgCaptionStaff" class="metric-caption">-</div>
              </article>

              <article class="dashboard-metric">
                <div class="metric-label">ฝ่าย / ชมรมใช้งบสูงสุด</div>
                <div id="topOrgNameStaff" class="metric-value">-</div>
                <div id="topOrgBudgetStaff" class="metric-caption">-</div>
              </article>
            </div>

            <div class="dashboard-grid"> 
              <article class="dashboard-metric">
                <div class="metric-label">อัตราอนุมัติโครงการ</div>
                <div class="donut-wrap">
                  <canvas id="approvalRateDonutStaff"></canvas>
                </div>
                <div id="approvalRateCaptionStaff" class="metric-caption">-</div>
              </article>

              <article class="dashboard-metric">
                <div class="kpi-label">การใช้จ่ายเทียบงบ</div>
                <div class="donut-wrap">
                  <canvas id="kpiBudgetUsageDonutStaff"></canvas>
                </div>
                <div class="kpi-caption" id="kpiBudgetUsageCaption">งบที่อนุมัติ vs ใช้จริง</div>
              </article>

              <article class="dashboard-metric">
                <div class="metric-label">อัตราปิดโครงการ</div>
                <div class="donut-wrap">
                  <canvas id="closureRateDonutStaff"></canvas>
                </div>
                <div id="closureRateCaptionStaff" class="metric-caption">-</div>
              </article>

              <article class="dashboard-metric">
                <div class="kpi-label">% ปิดโครงการตรงเวลา</div>
                <div class="donut-wrap">
                  <canvas id="kpiOnTimeDonutStaff"></canvas>
                </div>
                <div class="kpi-caption" id="kpiOnTimeCaption">กำลังประมวลผล</div>
              </article>
            </div>

            <div class="dashboard-charts-grid section-appear section-delay-2" style="margin-top:12px;">
              <article class="chart-card">
                  <header class="chart-header">
                    <h3 class="chart-title">จำนวนโครงการค้างปิดรายเดือน</h3>
                  </header>
                <div class="chart-inner">
                  <canvas id="trendLineChartStaff"></canvas>
                </div>
              </article>

              <article class="chart-card">
                <header class="chart-header">
                  <h3 class="chart-title">เปรียบเทียบรายเดือน</h3>
                  <p class="chart-caption" id="kpiMonthlyCaption">กำลังเตรียมข้อมูล</p>
                </header>
                <div class="chart-inner">
                  <canvas id="homeKpiChart" height="140"></canvas>
                </div>
              </article>
            </div>

            <div class="dashboard-charts-grid" style="margin-top:12px;">
              <article class="chart-card">
                <div class="calendar-heatmap-header">
                  <h4 class="calendar-heatmap-title">Heat map วันปฏิบัติงานวันสุดท้าย</h4>
                </div>
                <div class="heatmap-year">
                  <div id="homeHeatmapMonths" class="heatmap-axis heatmap-axis-months"></div>
                  <div class="heatmap-body">
                    <div class="heatmap-axis heatmap-axis-days" aria-hidden="true">
                      <span>อา</span>
                      <span>จ</span>
                      <span>อ</span>
                      <span>พ</span>
                      <span>พฤ</span>
                      <span>ศ</span>
                      <span>ส</span>
                    </div>
                    <div id="homeHeatmap" class="heatmap-year-grid"></div>
                  </div>
                </div>
                <div class="calendar-heatmap-legend" aria-hidden="true">
                  <span class="heatmap-legend-label">น้อย</span>
                  <span class="heatmap-legend-swatch heat-1"></span>
                  <span class="heatmap-legend-swatch heat-2"></span>
                  <span class="heatmap-legend-swatch heat-3"></span>
                  <span class="heatmap-legend-swatch heat-4"></span>
                  <span class="heatmap-legend-swatch heat-5"></span>
                  <span class="heatmap-legend-label">มาก</span>
                </div>
              </article>
            </div>

            <div class="dashboard-lower" style="margin-top:12px;">
              <article class="dashboard-card">
                <h4 class="dashboard-card-title">โครงการค้างปิดนานสุด</h4>
                <div class="project-table-wrapper">
                  <table id="longestOpenTableStaff">
                    <thead>
                      <tr>
                        <th style="text-align:center;">รหัสโครงการ</th>
                        <th style="text-align:center;">ชื่อโครงการ</th>
                        <th style="text-align:center;">ผู้ช่วย</th>
                        <th style="text-align:center;">สถานะปิดโครงการ</th>
                        <th style="text-align:right;">ยอดวันที่ค้าง</th>
                      </tr>
                    </thead>
                    <tbody id="longestOpenTableBodyStaff">
                      <!-- JS ใส่ข้อมูล -->
                    </tbody>
                  </table>
                </div>
              </article>
            </div>
          </section>
        </div>
      </section>

      <!-- ============ FINANCIAL DOCUMENTS ============ -->
      <section class="page-view" data-page="project-status-staff">
        <div class="page">
          <!-- Header + Toggle -->
          <div class="page-header-flex">
            <div>
              <h1 class="page-title">สถานะโครงการ (Staff)</h1>
            </div>

            <!-- Toggle ระหว่างมุมมองสรุป / ปฏิทิน -->
            <div class="tabs">
              <button
                class="tab-btn view-toggle-btn is-active"
                type="button"
                data-view="status-staff"
              >
                สรุปสถานะโครงการ
              </button>
              <button
                class="tab-btn view-toggle-btn"
                type="button"
                data-view="calendar-staff"
              >
                ปฏิทินโครงการ
              </button>
            </div>
          </div>

          <!-- Filter หลัก (ใช้ร่วม Status + Dashboard) -->
          <div id="filterBarHostStaff">
            <div id="filterBarStaff" class="filter-bar">
              <div class="filter-group filter-year">
                <label for="yearSelectStaff">ปีการศึกษา</label>
                <select id="yearSelectStaff">
                  <option value="all">ทุกปีการศึกษา</option>
                  <option value="2568" selected>2568</option>
                </select>
              </div>

              <div class="filter-group filter-orgtype">
                <label for="orgTypeSelectStaff">ประเภทองค์กร</label>
                <select id="orgTypeSelectStaff">
                  <option value="all">ทุกประเภทองค์กร</option>
                  <!-- JS จะเติมฝ่าย/กลุ่มองค์กรเพิ่ม -->
                </select>
              </div>

              <div class="filter-group filter-org">
                <label for="orgSelectStaff">ฝ่าย / ชมรม</label>
                <select id="orgSelectStaff">
                  <option value="all">ทุกฝ่าย / ทุกชมรม</option>
                  <!-- JS จะเติมรายชื่อชมรม/ฝ่ายเพิ่ม -->
                </select>
              </div>

              <div class="filter-group filter-search">
                <label for="projectSearchInputStaff">ค้นหาข้อความ (โค้ด / ชื่อ / ฝ่าย)</label>
                <div class="search-box">
                  <input
                    id="projectSearchInputStaff"
                    type="search"
                    placeholder="พิมพ์คำค้น เช่น SGCU-01 หรือ ชมรมกีฬา"
                  />
                  <button id="projectSearchClearStaff" class="search-clear" type="button" aria-label="เคลียร์คำค้น">
                    ✕
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- ================= STATUS VIEW ================= -->
          <div id="statusViewStaff">
            <!-- การ์ดสรุป -->
            <div class="cards section-appear section-delay-2">
              <article class="card card-hover">
                <div class="card-title">จำนวนโครงการทั้งหมด</div>
                <div id="totalProjectsStaff" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">โครงการอยู่ระหว่างดำเนินการ</div>
                <div id="pendingProjectsStaff" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">โครงการที่อนุมัติแล้ว</div>
                <div id="approvedProjectsStaff" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">โครงการที่ปิดโครงการแล้ว</div>
                <div id="closedProjectsStaff" class="card-value">0</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">วงเงินโครงการรวม (บาท)</div>
                <div id="totalBudgetStaff" class="card-value">0</div>
                <div class="card-caption">บาท</div>
              </article>
            </div>

            <!-- กราฟสถานะปิดโครงการ + Pie งบประมาณ -->
            <div class="chart-grid section-appear section-delay-3" style="margin-top:16px;">
              <!-- Stacked bar -->
              <article class="chart-card">
                <header class="chart-header">
                  <h3 class="chart-title">ภาพรวมสถานะปิดโครงการ</h3>
                </header>
                <div class="chart-inner">
                  <div id="budgetChartSkeletonStaff" class="chart-skeleton"></div>
                  <canvas id="budgetByMonthChartStaff"></canvas>
                </div>
              </article>

              <!-- Pie chart -->
              <article class="chart-card">
                <header class="chart-header">
                  <h3 class="chart-title">สัดส่วนงบประมาณโครงการที่ได้รับอนุมัติ</h3>
                </header>
                <div class="chart-inner">
                  <div id="statusPieSkeletonStaff" class="chart-skeleton"></div>
                  <canvas id="statusPieChartStaff"></canvas>
                </div>
              </article>
            </div>

            <!-- ตารางรายการโครงการ -->
            <section class="panel section-appear section-delay-4" style="margin-top:18px;">
              <header class="panel-header">
                <div>
                  <h3 class="panel-title">รายการโครงการ</h3>
                </div>
              </header>

              <div class="table-wrapper" id="projectTableAreaStaff">
                <div class="project-table-wrapper">
                  <table id="projectTableStaff">
                    <caption id="tableCaptionStaff">แสดง 0 โครงการ</caption>
                    <thead>
                      <tr>
                        <th style="text-align:center;">รหัสโครงการ</th>
                        <th style="text-align:center;">ชื่อโครงการ</th>
                        <th class="sortable" data-sort="year" style="text-align:center;">
                          ปีการศึกษา
                        </th>
                        <th class="sortable" data-sort="status" style="text-align:center;">
                          สถานะ
                        </th>
                        <th class="sortable" data-sort="budget" style="text-align:right;">
                          งบประมาณ (บาท)
                        </th>
                      </tr>
                    </thead>
                    <tbody id="projectTableBodyStaff">
                      <!-- JS ใส่ข้อมูลโครงการ -->
                    </tbody>
                  </table>
                </div>

                <div id="projectTableSkeletonStaff" class="table-skeleton"></div>
              </div>

              <div id="projectTableLockStaff" class="panel project-lock-panel">
                <h3 class="panel-title">ต้องเข้าสู่ระบบก่อน</h3>
                <p class="panel-caption">
                  กรุณาล็อกอินเพื่อดูรายละเอียดโครงการ
                </p>
                <div style="margin-top:10px;">
                  <button class="btn-primary" type="button" data-goto-page="login">ไปที่หน้า Sign in</button>
                </div>
              </div>
            </section>
          </div>

          <!-- ================= CALENDAR VIEW ================= -->
          <div id="calendarViewStaff" style="display:none; margin-top:12px;">
            <section class="panel section-appear section-delay-1">
              <header class="panel-header">
                <div>
                  <h3 id="calendarPanelTitleStaff" class="panel-title">
                    ปฏิทินกิจกรรม —
                  </h3>
                  <p class="panel-caption">
                    แสดงวันจัดกิจกรรมตามวันสิ้นสุดการปฏิบัติงานของแต่ละโครงการ
                  </p>
                </div>
                <div class="calendar-controls">
                  <button id="prevMonthBtnStaff" type="button" class="btn-ghost">
                    ‹ เดือนก่อนหน้า
                  </button>
                  <button id="nextMonthBtnStaff" type="button" class="btn-ghost">
                    เดือนถัดไป ›
                  </button>
                </div>
              </header>

              <!-- Filters -->
              <div class="calendar-filter-bar">
                <div class="filter-group">
                  <label for="calendarYearSelectStaff">ปีการศึกษา</label>
                  <select id="calendarYearSelectStaff">
                    <option value="all">ทุกปีการศึกษา</option>
                  </select>
                </div>
                <div class="filter-group">
                  <label for="calendarOrgSelectStaff">ฝ่าย / ชมรม</label>
                  <select id="calendarOrgSelectStaff">
                    <option value="all">ทุกฝ่าย / ทุกชมรม</option>
                  </select>
              </div>
              <div class="filter-group">
                <label for="calendarStatusSelectStaff">สถานะโครงการ</label>
                <select id="calendarStatusSelectStaff">
                  <option value="all">ทุกสถานะ</option>
                    <option value="pending">อยู่ระหว่างดำเนินการ</option>
                    <option value="approved">อนุมัติโครงการแล้ว</option>
                    <option value="closed">ปิดโครงการแล้ว</option>
                  </select>
                </div>
              </div>

              <!-- Skeleton ปฏิทิน -->
              <div id="calendarSkeletonStaff" class="calendar-skeleton" aria-hidden="true">
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
                <div class="calendar-skeleton-cell"></div>
              </div>

              <!-- กริดปฏิทิน -->
              <div id="calendarContainerStaff" class="calendar-grid"></div>

              <div class="home-timeline-footer" style="margin-top:12px;">
                <span class="pill pill-soft-gray">อยู่ระหว่างดำเนินการ</span>
                <span class="pill pill-soft-pink">อนุมัติโครงการแล้ว</span>
                <span class="pill pill-soft-green">ปิดโครงการแล้ว</span>
              </div>
            </section>
          </div>

        </div>
      </section>


      <!-- ============ FINANCIAL DOCUMENTS ============ -->
      <section class="page-view" data-page="financial-docs">
        <div class="page">
          <div class="page-header-flex section-appear">
            <div>
              <h2 class="page-title">Financial Documents</h2>
              <p class="page-subtitle">
                รวมแบบฟอร์มและเอกสารมาตรฐานด้านการเงินของฝ่ายเหรัญญิก · สำหรับโครงการและชมรม
              </p>
            </div>
          </div>

          <div class="separator-gradient"></div>

          <div class="section-appear section-delay-2">
            <div id="downloadSkeleton" class="download-skeleton" aria-hidden="true">
              <div class="download-skeleton-card">
                <div class="skeleton-line short"></div>
                <div class="skeleton-line"></div>
                <div class="skeleton-line tiny"></div>
              </div>
              <div class="download-skeleton-card">
                <div class="skeleton-line short"></div>
                <div class="skeleton-line"></div>
                <div class="skeleton-line tiny"></div>
              </div>
              <div class="download-skeleton-card">
                <div class="skeleton-line short"></div>
                <div class="skeleton-line"></div>
                <div class="skeleton-line tiny"></div>
              </div>
            </div>
            <div id="downloadList" class="download-wrapper">
              <!-- เติมด้วย JS -->
            </div>
          </div>
        </div>
      </section>

      <!-- ============ BORROW & RETURN ASSETS ============ -->
      <section class="page-view" data-page="borrow-assets">
        <div class="page">
          <div class="page-header-flex section-appear">
            <div>
              <h2 class="page-title">Borrow &amp; Return Assets</h2>
              <p class="page-subtitle">
                ดูสถานะการยืมครุภัณฑ์และอุปกรณ์ส่วนกลางของ SGCU
                รวมถึงรายการที่ใกล้ครบกำหนดคืน
              </p>
            </div>

            <div class="tabs">
              <button
                class="tab-btn is-active"
                data-assets-tab="overview"
                type="button"
              >
                ภาพรวมวันนี้
              </button>
              <button
                class="tab-btn"
                data-assets-tab="list"
                type="button"
              >
                รายการทั้งหมด
              </button>
            </div>
          </div>

          <!-- Overview -->
          <div id="assetsOverview" class="section-appear section-delay-1">
            <div class="cards" style="margin-bottom: 14px">
              <article class="card card-hover">
                <div class="card-title">จำนวนรายการที่ถูกยืมอยู่</div>
                <div class="card-value" data-countup="12">12</div>
                <div class="card-caption">รวมทุกฝ่าย ณ วันนี้ (ตัวอย่าง)</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">จะครบกำหนดคืนภายใน 3 วัน</div>
                <div class="card-value" data-countup="4">4</div>
                <div class="card-caption">รายการที่ควรติดตาม</div>
              </article>

              <article class="card card-hover">
                <div class="card-title">เกินกำหนดคืนแล้ว</div>
                <div class="card-value" style="color: #ef4444" data-countup="1">
                  1
                </div>
                <div class="card-caption">ควรติดต่อผู้ยืมโดยด่วน</div>
              </article>
            </div>

            <div class="panel panel-hover">
              <div class="panel-header">
                <div>
                  <div class="panel-title">รายการใกล้ครบกำหนดคืน</div>
                  <div class="panel-caption">
                    ตัวอย่าง layout สำหรับรายการที่กำลังใช้งาน
                    และกำลังจะครบกำหนด
                  </div>
                </div>
              </div>

              <div class="org-grid-2x2">
                <article
                  class="asset-card section-appear section-delay-1"
                >
                  <div class="asset-card-header">
                    <div class="asset-card-title">
                      ไมโครโฟนไร้สาย (ชุดที่ 1)
                    </div>
                    <span class="pill pill-soft-pink">ครบกำหนดใน 2 วัน</span>
                  </div>
                  <div class="asset-card-meta">
                    ผู้ยืม: ชมรมดนตรีสากล · ใช้ในงานประกวดดนตรี<br />
                    วันที่ยืม: 10 ต.ค. 2568 · กำหนดคืน: 15 ต.ค. 2568
                  </div>
                  <div class="asset-card-footer">
                    <span>ผู้รับผิดชอบ: ผู้ช่วยเหรัญญิกฝ่ายกายภาพ</span>
                    <button class="btn-ghost" type="button">
                      ดูรายละเอียด
                    </button>
                  </div>
                </article>

                <article
                  class="asset-card section-appear section-delay-2"
                >
                  <div class="asset-card-header">
                    <div class="asset-card-title">
                      เก้าอี้พลาสติก (50 ตัว)
                    </div>
                    <span class="pill pill-soft-gray">ครบกำหนดวันนี้</span>
                  </div>
                  <div class="asset-card-meta">
                    ผู้ยืม: ฝ่ายกิจกรรม SGCU · ใช้ในงานรับน้องคณะรวม<br />
                    วันที่ยืม: 5 ต.ค. 2568 · กำหนดคืน: 12 ต.ค. 2568
                  </div>
                  <div class="asset-card-footer">
                    <span>สถานะ: รอเช็คคืน</span>
                    <button class="btn-ghost" type="button">
                      ดูรายละเอียด
                    </button>
                  </div>
                </article>
              </div>
            </div>
          </div>

          <!-- List -->
          <div
            id="assetsList"
            class="section-appear"
            style="display: none; margin-top: 18px"
          >
            <div class="panel panel-hover">
              <div class="panel-header">
                <div>
                  <div class="panel-title">รายการยืมครุภัณฑ์ทั้งหมด</div>
                  <div class="panel-caption">
                    ส่วนนี้คุณสามารถผูกกับ Google Sheets
                    หรือระบบยืมคืนของคุณเองได้
                  </div>
                </div>
              </div>

              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>รายการ</th>
                      <th>ผู้ยืม</th>
                      <th>วันที่ยืม</th>
                      <th>กำหนดคืน</th>
                      <th>สถานะ</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>ชุดเครื่องเสียงกลาง (Set A)</td>
                      <td>ชมรมดนตรีไทย</td>
                      <td>01/10/2568</td>
                      <td>10/10/2568</td>
                      <td><span class="badge badge-pending">รอคืน</span></td>
                    </tr>
                    <tr>
                      <td>ทรงธง SGCU</td>
                      <td>องค์การบริหารสโมสรนิสิต</td>
                      <td>03/10/2568</td>
                      <td>03/10/2568</td>
                      <td>
                        <span class="badge badge-approved">คืนแล้ว</span>
                      </td>
                    </tr>
                    <!-- เติมข้อมูลจริงด้วย JS ได้ภายหลัง -->
                  </tbody>
                </table>
              </div>

            </div>
          </div>
        </div>
      </section>


      <!-- ============ STAFF: BORROW ASSETS ============ -->
      <section class="page-view" data-page="borrow-assets-staff">
        <div class="page">
          <div class="page-header-flex section-appear">
            <div>
              <h2 class="page-title">borrow-assets for Staff</h2>
              <p class="page-subtitle">พื้นที่จัดการครุภัณฑ์และการคืนของ (เฉพาะ Staff)</p>
            </div>
          </div>

          <div class="panel panel-hover section-appear section-delay-1">
            <div class="panel-header">
              <div>
                <div class="panel-title">Coming Soon</div>
                <div class="panel-caption">รายการยืมคืนและการอนุมัติภายในทีม</div>
              </div>
            </div>
            <div class="panel-body">
              <p>ระบบสำหรับ Staff จะถูกเชื่อมต่อในหน้านี้ หากมีข้อสงสัยติดต่อฝ่ายเหรัญญิก</p>
            </div>
          </div>
        </div>
      </section>


      <section class="page-view page-news" data-page="news">
        <div class="container">
          <header class="news-hero">
            <div>
              <p class="news-hero-eyebrow">Treasurer SGCU68</p>
              <h2 class="news-hero-title">ข่าวและประกาศจากฝ่ายเหรัญญิก</h2>
              <p class="news-hero-subtitle">
                ติดตามประกาศสำคัญ แนวปฏิบัติ และไฟล์ดาวน์โหลดล่าสุดสำหรับองค์กรและชมรม
              </p>
            </div>
          </header>

          <div id="newsListSkeleton" class="news-list-skeleton" aria-hidden="true">
            <div class="skeleton-card">
              <div class="skeleton-line short"></div>
              <div class="skeleton-line"></div>
              <div class="skeleton-line"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-line short"></div>
              <div class="skeleton-line"></div>
              <div class="skeleton-line"></div>
            </div>
            <div class="skeleton-card">
              <div class="skeleton-line short"></div>
              <div class="skeleton-line"></div>
              <div class="skeleton-line"></div>
            </div>
          </div>

          <div id="newsList" class="news-list"></div>
        </div>
      </section>
    </main>

    <!-- PDF Template (Hidden) -->
    <div id="pdfRoot" class="pdf-root" aria-hidden="true">
      <!-- Page 1: Advance Letter -->
      <section class="pdf-flow">
        <div class="pdf-header">
          <img class="pdf-banner" src="img/banner SGCU.jpg" alt="SGCU" />
        </div>

        <div class="pdf-center-title">แบบบันทึกยืมรองจ่าย (กำลังพัฒนา)</div>
        <div class="pdf-row-between">
          <div>ที่ อบจ. 10.01.01-……/2568</div>
          <div>เหรัญญิก <br> องค์การบริหารสโมสรนิสิต <br> จุฬาลงกรณ์มหาวิทยาลัย</div>
        </div>

        <div class="pdf-paragraph">
          เรื่อง  ขออนุมัติยืมเงินรองจ่าย
        </div>
        <div class="pdf-paragraph">
          เรียน  รองอธิการบดี (รองศาสตราจารย์ ดร.สุกัญญา สมไพบูลย์)
        </div>
        <div class="pdf-paragraph">
          &emsp;ตามที่ <span class="pdf-fill pdf-fill-lg" data-pdf-field="orgGroup"></span> 
          ได้รับอนุมัติงบประมาณจากเงินงบสโมสรนิสิตเพื่อใช้ในการดำเนิน <span class="pdf-fill pdf-fill-lg" data-pdf-field="projectName"></span> 
          ซึ่งจัดขึ้นในระหว่าง <span class="pdf-fill pdf-fill-md" data-pdf-field="projectDateRange"></span>
          ในวงเงิน <span class="pdf-fill pdf-fill-md" data-pdf-field="approvedBudget100Text"></span> บาท 
          (<span class="pdf-fill pdf-fill-lg" data-pdf-field="approvedBudget100Words"></span>)
        </div>
        <div class="pdf-paragraph">
          &emsp;ในการนี้ <span class="pdf-fill pdf-fill-lg" data-pdf-field="orgName"></span> 
          ขออนุมัติยืมเงินรองจ่ายร้อยละ <span class="pdf-fill pdf-fill-sm" data-pdf-field="advancePercentText"></span> 
          เป็นเงิน <span class="pdf-fill pdf-fill-md" data-pdf-field="approvedBudget80Text"></span> บาท 
          ( <span class="pdf-fill pdf-fill-lg" data-pdf-field="approvedBudget80Words"></span> )
          โดยกิจกรรมดังกล่าวผ่านที่ประชุมสภานิสิต
          <span class="pdf-fill pdf-fill-lg" data-pdf-field="councilSessionText"></span>
        </div>
        <div class="pdf-paragraph">
          &emsp;ทั้งนี้ ผู้รับผิดชอบโครงการจะต้องดำเนินการส่งเอกสารหลักฐานการใช้งบประมาณ ให้เหรัญญิกของคณะกรรมการบริหารในวันที่ 
          <span class="pdf-fill pdf-fill-sm" data-pdf-field="evidenceDueDateText"></span>
          มิฉะนั้น เหรัญญิกของคณะกรรมการบริหารจะดำเนินการระงับการเบิกจ่ายเงินในโครงการอื่น ๆ ที่เกี่ยวข้องต่อไป 
          โดยอาศัยอำนาจตามความในข้อ 26 แห่งระเบียบจุฬาลงกรณ์มหาวิทยาลัย ว่าด้วยการเงิน 
          การงบประมาณและการเบิกจ่ายเงินรายได้ของสโมสรนิสิต พ.ศ. 2547
        </div>
        <div class="pdf-paragraph">
            &emsp;จึงเรียนมาเพื่อโปรดพิจารณาอนุมัติ
        </div>

        <div class="pdf-signature-block pdf-signature-right">
          <div class="pdf-sign-role">ขอแสดงความนับถือ</div>
          <div><br><br></div>
          <div class="pdf-sign-line"></div>
          <div class="pdf-sign-name">(<span data-pdf-field="projectLeadName"></span>)</div>
          <div class="pdf-sign-role">ประธานโครงการ <span class="pdf-fill pdf-fill-lg" data-pdf-field="projectName"></span></div>

          <div><br><br></div>
          <div class="pdf-sign-line"></div>
          <div class="pdf-sign-name">(<span data-pdf-field="signerTreasurerName"></span>)</div>
          <div class="pdf-sign-role">เหรัญญิก</div>
          <div class="pdf-sign-org">องค์การบริหารสโมสรนิสิตจุฬาลงกรณ์มหาวิทยาลัย</div>

          <div><br><br></div>
          <div class="pdf-sign-line"></div>
          <div class="pdf-sign-name">(<span data-pdf-field="signerPresidentName"></span>)</div>
          <div class="pdf-sign-role">นายกสโมสร</div>
          <div class="pdf-sign-org">องค์การบริหารสโมสรนิสิตจุฬาลงกรณ์มหาวิทยาลัย</div>
        </div>

      </section>


      <!-- Page 2: Request Form -->
      <section class="pdf-page pdf-page-break">
        <div class="pdf-header">
          <img class="pdf-banner" src="img/banner SGCU.jpg" alt="SGCU" />
        </div>

        <div class="pdf-center-title">ขอยืมเงินรองจ่าย</div>
        <div class="pdf-row-between">
          <div>ที่ อบจ. 10.01.01-……/2568</div>
          <div>องค์การบริหารสโมสรนิสิต</div>
        </div>

        <div class="pdf-paragraph">
          &emsp;<span class="pdf-fill pdf-fill-xl" data-pdf-field="projectName"></span> 
          ได้รับการอนุมัติงบจากที่ประชุมสภานิสิต <span class="pdf-fill pdf-fill-lg" data-pdf-field="councilSessionText"></span> 
          จัดกิจกรรมใน <span class="pdf-fill pdf-fill-md" data-pdf-field="projectDateRange"></span>
        </div>

        <table class="pdf-table">
          <thead>
            <tr>
              <th>ลำดับ</th>
              <th>รายการ</th>
              <th>จำนวนเงิน</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>จำนวนเงินงบประมาณที่ได้รับการอนุมัติ</td>
              <td><span data-pdf-field="approvedBudget100Text"></span></td>
            </tr>
            <tr>
              <td>2</td>
              <td>จำนวนเงินยืมรองจ่าย</td>
              <td><span data-pdf-field="approvedBudget80Text"></span></td>
            </tr>
            <tr>
              <td colspan="2" class="pdf-table-total">รวม</td>
              <td class="pdf-table-total-amount"><span data-pdf-field="approvedBudget80Text"></span></td>
            </tr>
          </tbody>
        </table>

        <div class="pdf-line">
          <span class="label">รวมเป็นเงิน</span>
          <span class="pdf-fill pdf-fill-lg" data-pdf-field="approvedBudget80Words"></span>
          <span class="label">บาท</span>
        </div>

        <div class="pdf-signature-block pdf-signature-right">
          <div class="pdf-sign-line"></div>
          <div class="pdf-sign-name">(<span data-pdf-field="projectLeadName"></span>)</div>
          <div class="pdf-sign-role">ประธานโครงการ <span class="pdf-fill pdf-fill-lg" data-pdf-field="projectName"></span></div>
        </div>
        <div class="pdf-right-block">
          <div>โอนเงินเข้าบัญชีองค์การบริหารสโมสรนิสิตจุฬาฯ</div>
          <div>เลขที่บัญชี 407-313892-5</div>
          <div>โทรศัพท์ <span data-pdf-field="projectLeadPhone"></span>, 094-969-6495</div>
        </div>
      </section>

      <!-- Page 4: Sections 1-3 -->
      <section class="pdf-page">
        <div class="pdf-section">
          <div class="pdf-section-title">ส่วนที่ 1</div>
          <div class="pdf-section-subtitle">ส่วนการลงบัญชี</div>
          <div class="pdf-grid">
            <div class="pdf-line">
              <span class="label">เงินจ่ายลงหน้าเลขที่</span>
              <span class="pdf-fill pdf-fill-sm"></span>
            </div>
            <div class="pdf-line">
              <span class="label">จำนวนเงิน</span>
              <span class="pdf-fill pdf-fill-md"></span>
              <span class="label">บาท</span>
            </div>
            <div class="pdf-line">
              <span class="label">ลงบัญชีวันที่</span>
              <span class="pdf-fill pdf-fill-md"></span>
            </div>
            <div class="pdf-line">
              <span class="label">ผู้ลงบัญชี</span>
              <span class="pdf-fill pdf-fill-lg"></span>
            </div>
          </div>
        </div>

        <div class="pdf-section">
          <div class="pdf-section-title">ส่วนที่ 2</div>
          <div class="pdf-section-subtitle">ส่วนที่บันทึกเมื่อมีการส่งฎีกา</div>
          <div class="pdf-grid">
            <div class="pdf-line">
              <span class="label">ฎีกาเลขที่</span>
              <span class="pdf-fill pdf-fill-md"></span>
            </div>
            <div class="pdf-line">
              <span class="label">จำนวนเงินส่งคืน</span>
              <span class="pdf-fill pdf-fill-md"></span>
              <span class="label">บาท</span>
            </div>
            <div class="pdf-line">
              <span class="label">ลงบัญชีวันที่</span>
              <span class="pdf-fill pdf-fill-md"></span>
            </div>
            <div class="pdf-line">
              <span class="label">ผู้ลงบัญชี</span>
              <span class="pdf-fill pdf-fill-lg"></span>
            </div>
          </div>
          <div class="pdf-note">*หมายเหตุ เฉพาะกรณีที่เงินรองจ่ายมากกว่าจำนวนเงินที่ส่งเบิก</div>
        </div>

        <div class="pdf-section">
          <div class="pdf-section-title">ส่วนที่ 3</div>
          <div class="pdf-section-subtitle">ข้อแนะนำ</div>
          <ol class="pdf-list">
            <li>ให้กรอกเฉพาะส่วนที่ 1 เท่านั้น</li>
            <li>เอกสารที่ต้องนำเบิกมี แบบบันทึกยืมเงินรองจ่าย      ขอยืมเงินรองจ่าย    จดหมายอนุมัติกิจกรรม และ เอกสารโครงการ</li>
          </ol>
        </div>
      </section>
    </div>

    <!-- Project Modal -->
    <div id="projectModal" class="modal">
      <div class="modal-dialog">
        <div class="modal-header">
          <div>
            <div id="projectModalTitle" class="modal-title"></div>
            <div id="projectModalHeaderRow" class="modal-header-row"></div>
          </div>
          <button id="projectModalClose" class="modal-close" type="button" aria-label="ปิดหน้าต่างรายละเอียดโครงการ">
            ✕
          </button>
        </div>
        <div class="modal-subtitle">
          <span id="projectModalTitleBadge" class="modal-badge"></span>
        </div>
        <div id="projectModalBody" class="modal-body"></div>
      </div>
    </div>

    <!-- Calendar Modal -->
    <div id="calendarModal" class="modal">
      <div class="modal-dialog">
        <div class="modal-header">
          <div>
            <div id="calendarModalTitle" class="modal-title"></div>
          </div>
          <button id="calendarModalClose" class="modal-close" type="button" aria-label="ปิดหน้าต่างปฏิทิน">
            ✕
          </button>
        </div>
        <div id="calendarModalBody" class="modal-body"></div>
      </div>
    </div>

    <!-- Person Popup -->
    <div id="personModal" class="person-modal">
      <div class="person-modal-backdrop"></div>
      <div class="person-modal-dialog">
        <button id="personModalClose" class="person-modal-close" aria-label="ปิดรายละเอียดบุคคล">×</button>

        <div class="person-modal-header">
          <div id="personModalAvatar" class="person-modal-avatar"></div>
          <div>
            <div id="personModalPosition" class="person-modal-position"></div>
            <div id="personModalName" class="person-modal-name"></div>
            <div id="personModalNick" class="person-modal-nick"></div>
          </div>
        </div>

        <div id="personModalExtra" class="person-modal-extra">
          <!-- JS เติมเบอร์/LINE -->
        </div>
        <div id="personModalContact" class="person-modal-contact"></div>
      </div>
    </div>

    <div id="newsModal" class="modal">
      <div class="modal-dialog">
        <div class="modal-header">
          <div>
            <div id="newsModalTitle" class="modal-title"></div>
          </div>
          <button id="newsModalClose" type="button" class="modal-close" aria-label="ปิด">
            ✕
          </button>
        </div>
        <div id="newsModalBody" class="modal-body"></div>
      </div>
    </div>

    <!-- LOGIN PAGE -->
    <section class="page-view" data-page="login">
      <div class="page login-page">
        <div class="page-header-flex">
          <div>
            <h1 class="page-title">เข้าสู่ระบบ</h1>
            <p class="page-subtitle">เข้าสู่ระบบด้วยบัญชี Google ที่ได้รับอนุญาต</p>
          </div>
        </div>

        <div class="login-shell">
          <div class="login-hero">
            <div class="login-hero-content">
              <div class="login-hero-eyebrow">Treasurer SGCU 68</div>
              <h2 class="login-hero-title">ศูนย์กลางงานการเงินของนิสิต</h2>
              <p class="login-hero-lead">
                เข้าสู่ระบบเพื่อดูสถานะโครงการ งบประมาณ และเอกสารการเงินแบบเป็นทางการ
                ข้อมูลทั้งหมดอัปเดตแบบโปร่งใสและตรวจสอบย้อนหลังได้
              </p>
              <div class="login-hero-list">
                <div class="login-hero-item">
                  <span class="login-hero-icon" aria-hidden="true">+</span>
                  <span>ติดตามการอนุมัติและเบิกจ่ายแบบเรียลไทม์</span>
                </div>
                <div class="login-hero-item">
                  <span class="login-hero-icon" aria-hidden="true">+</span>
                  <span>จัดเก็บเอกสารการเงินในที่เดียว</span>
                </div>
                <div class="login-hero-item">
                  <span class="login-hero-icon" aria-hidden="true">+</span>
                  <span>ยืนยันตัวตนด้วยบัญชี Google ของหน่วยงาน</span>
                </div>
              </div>
              <div class="login-hero-meta">
                <div class="login-hero-chip">Secure Access</div>
                <div class="login-hero-chip">SGCU 68</div>
                <div class="login-hero-chip">Finance Hub</div>
              </div>
            </div>

            <div class="login-hero-panel">
              <div class="login-grid">
                <div id="loginGooglePanel" class="panel panel-hover login-card">
                  <h3 class="login-title">ล็อกอินด้วย Google</h3>
                  <p class="login-caption">ใช้บัญชีที่ได้รับสิทธิ์เพื่อเข้าใช้งานระบบ</p>
                  <button id="loginPageGoogleBtn" type="button" class="btn-primary w-full">Sign in with Google</button>
                  <div class="login-status" id="loginPageStatus"></div>
                  <button id="loginPageLogoutBtn" type="button" class="btn-secondary w-full" style="display:none;">Sign Out</button>
                </div>
              </div>
              <div class="login-help">
                <div class="login-help-title">ยังไม่มีสิทธิ์เข้าใช้งาน?</div>
                <p class="login-help-text">ติดต่อฝ่ายเหรัญญิกเพื่อขอเพิ่มสิทธิ์เข้าระบบ</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer class="site-footer">
      <div class="footer-inner">
        <span>Treasurer SGCU 68</span>
        <span>© <span id="footerYear"></span> All rights reserved.</span>
      </div>
    </footer>

    <script src="js/app.js" defer></script>
  </body>
</html>
